<?php

namespace Repository;

use Doctrine\ORM\EntityRepository;
use Entity\Beneficiary;
use Entity\Assistance;
use Entity\GeneralReliefItem;
use Doctrine\ORM\Tools\Pagination\Paginator;
use InputType\GeneralReliefFilterInputType;
use Request\Pagination;

/**
 * GeneralReliefItemRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class GeneralReliefItemRepository extends EntityRepository
{
    /**
     *
     * @return Paginator|GeneralReliefItem[]
     */
    public function findByParams(GeneralReliefFilterInputType $filter, ?Pagination $pagination = null): Paginator
    {
        $qbr = $this->createQueryBuilder('gri');

        if ($pagination) {
            $qbr->setMaxResults($pagination->getLimit())
                ->setFirstResult($pagination->getOffset());
        }

        if ($filter->hasIds()) {
            $qbr->andWhere('gri.id IN (:ids)')
                ->setParameter('ids', $filter->getIds());
        }

        return new Paginator($qbr);
    }
}
